<!DOCTYPE html>
<title>Elements the War</title>
<link rel="stylesheet" href="ui.css">
<style>
td{width:200px}
</style>
<script src="util.js"></script>
<script src="carddb.js"></script>
<pre id="outcode">Click to select</pre>
<table id="maindiv0"></table>
<table id="maindiv1"></table>
<script>
(function(){
	"use strict";
	function updateCode(){
		clearDiv(outcode);
		var dcode = [];
		cellMap.forEach(function(x){
			var num = parseInt(x.input.value);
			for(var i=0; i<num; i++){
				dcode.push(x.code);
			}
		});
		outcode.appendChild(document.createTextNode(dcode.join(" ")));
	}
	outcode.addEventListener("click", function selectNode(){
		var range = document.createRange();
		range.selectNodeContents(outcode);
		var sel = getSelection();
		sel.removeAllRanges();
		sel.addRange(range);
	});
	var cards = [], cellMap = [];
	for(var i=0; i<13; i++) cards.push([]);
	for(var code in Cards){
		var card = Cards[code];
		cards[card.element].push(card);
	}
	cards.forEach(function(clist, i){
		clist.sort(function(x,y){return x.cost-y.cost});
		var ediv = document.createElement("td");
		clist.forEach(function(card){
			if (card.upped) return;
			var tr = document.createElement("tr");
			var input = document.createElement("input");
			input.className = "numput ecol";
			input.addEventListener("input", updateCode);
			cellMap.push({input:input, code:card.code});
			tr.appendChild(input);
			tr.appendChild(document.createTextNode(card.name));
			ediv.appendChild(tr);
		});
		document.getElementById("maindiv"+Math.floor(i/7)).appendChild(ediv);
	});
})();
</script>