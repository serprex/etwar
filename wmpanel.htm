<title>WM panel</title>
<link rel="stylesheet" href="ui.css">
<script src="util.js"></script>
<!-- Have some auth that we send to server to verify in some gitignore dot file. Then expose creating a team, setting members of team, generating matches, inputting results, penalties -->
<div id="maindiv"></div>
<script>
function requestAuth(pass){
	var xhr = new XMLHttpRequest();
	xhr.addEventListener("error", createLoginForm);
	xhr.addEventListener("load", createPanel);
	xhr.open("GET", "wmlogin?auth="+encodeURIComponent(pass), true);
	xhr.send();
}
function createLoginForm(){
	clearDiv(maindiv);
	document.createElement("input");
	input.placeholder="auth";
	input.addEventListener("keydown", function(e){
		if (e.keyCode == 13){
			localStorage.auth = input.value;
			requestAuth(input.value);
		}
	});
	maindiv.appendChild(input);
}
function createPanel(){
	clearDiv(maindiv);
	var result = JSON.parse(this.responseText);
	var makeTeamEle = document.createElement("input");
	var makeTeamSize = document.createElement("input");
	var makeTeam = document.createElement("input");
	makeTeamEle.placeholder = "E";
	makeTeamSize.placeholder = "Size";
	makeTeam.type = "button";
	makeTeam.value = "Create Team";
	makeTeam.addEventListener("click", function(){
		var xhr = new XMLHttpRequest();
		xhr.open("GET", "createteam?"+mkQuery({auth:localStorage.auth, e:makeTeamEle.value, s:makeTeamSize.value}));
		xhr.send();
	});
	maindiv.appendChild(makeTeamEle);
	maindiv.appendChild(makeTeamSize);
	maindiv.appendChild(makeTeam);
}
requestAuth(localStorage.auth); // Could skip straight to createLoginForm if auth doesn't exist, but I'd rather write this comment
</script>