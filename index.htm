<!DOCTYPE html>
<title>Elements the War</title>
<link rel="stylesheet" href="ui.css">
<script src="util.js"></script>
<div id="maindiv"></div>
<!-- Start with element select, once auth works save that as local setting. Otherwise go straight to deck management. No chat, standings is own url -->
<script>
function requestAuth(){
	xhrSend("teamlogin?"+mkAuthQuery({}), createMainView, createLoginForm);
}
function mkAuthQuery(query){
	query.team = localStorage.team;
	query.auth = localStorage.tauth;
	return query;
}
function xhrSend(cmd, onload, onerror){
	var xhr = new XMLHttpRequest();
	if (onload) xhr.addEventListener("load", onload);
	if (onerror) xhr.addEventListener("error", onerror);
	xhr.open("GET", url, true);
	xhr.send();
}
function createLoginForm(){
	clearDiv(maindiv);
	var team = document.createElement("input");
	var pswd = document.createElement("input");
	team.placeholder="team";
	pswd.placeholder="auth";
	function onkeydown(e){
		if (e.keyCode == 13){
			localStorage.team = team.value;
			localStorage.tauth = pswd.value;
			requestAuth();
		}
	}
	team.addEventListener("keydown", onkeydown);
	pswd.addEventListener("keydown", onkeydown);
	maindiv.appendChild(team);
	maindiv.appendChild(pswd);
}
function createMainView(){
	clearDiv(maindiv);
	var viewVault = document.createElement("a");
	viewVault.href = "#";
	viewVault.addEventListener("click", function(){
		xhrSend("viewvault?"+mkAuthQuery({}), createViewVault);
	});
}
function createViewVault(){
	// TODO, include interface to set vault during first round
}
requestAuth(); // Could skip straight to createLoginForm if auth doesn't exist, but I'd rather write this comment
</script>